{"intl":"var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n","src":"/** @module tfw.data-binding */require( 'tfw.data-binding', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n    /**\r\n * @module\r\n *\r\n * Provide all the functions needed for data-binding.\r\n *\r\n * @example\r\n * var DB = require('tfw.data-binding');\r\n * DB.propAddClass( widget, 'visible', 'show' );\r\n */\r\nrequire(\"polyfill.string\");\r\nvar $ = require(\"dom\");\r\nvar ParseUnit = require(\"tfw.css\").parseUnit;\r\nvar Listeners = require(\"tfw.listeners\");\r\n\r\n\r\nvar ID = '_tfw.data-binding_';\r\n\r\nvar converters = {\r\n    castArray: function(v) {\r\n        if (Array.isArray( v )) return v;\r\n        if( v === null || v === undefined ) return [];\r\n        return [v];\r\n    },\r\n    castBoolean: function(v) {\r\n        if (typeof v === 'boolean') return v;\r\n        if (typeof v === 'string') {\r\n            v = v.trim().toLowerCase();\r\n            if (v == '1' || v == 'true' || v == 'yes') {\r\n                return true;\r\n            } else if (v == '0' || v == 'false' || v == 'no') {\r\n                return false;\r\n            }\r\n        }\r\n        if (typeof v === 'number') {\r\n            return v ? true : false;\r\n        }\r\n        return null;\r\n    },\r\n    castColor: function(v) {\r\n        return \"\" + v;\r\n    },\r\n    castDate: function(v) {\r\n        if( typeof v === 'number' || typeof v === 'string' )\r\n            return new Date(v);\r\n        if( v instanceof Date ) return v;\r\n        return new Date();\r\n    },\r\n    castEnum: function( enumeration ) {\r\n        var lowerCaseEnum = enumeration.map(String.toLowerCase);\r\n        return function(v) {\r\n            if (typeof v === 'number') {\r\n                return enumeration[Math.floor( v ) % enumeration.length];\r\n            }\r\n            if (typeof v !== 'string') return enumeration[0];\r\n            var idx = lowerCaseEnum.indexOf( v.trim().toLowerCase() );\r\n            if (idx < 0) idx = 0;\r\n            return enumeration[idx];\r\n        };\r\n    },\r\n    castInteger: function(v) {\r\n        if (typeof v === 'number') {\r\n            return Math.floor( v );\r\n        }\r\n        if (typeof v === 'boolean') return v ? 1 : 0;\r\n        if (typeof v === 'string') {\r\n            return parseInt( v );\r\n        }\r\n        return Number.NaN;\r\n    },\r\n    castRegexp: function(v) {\r\n        if (v instanceof RegExp) return v;\r\n        if (typeof v === 'string' && v.trim().length != 0 ) {\r\n            try {\r\n                return new RegExp( v );\r\n            }\r\n            // Ignore Regular Expression errors.\r\n            catch (ex) {\r\n                console.error(\"[castRegexp] /\" + v + \"/ \", ex);\r\n            }\r\n        };\r\n        return null;\r\n    },\r\n    castString: function(v) {\r\n        if (typeof v === 'string') return v;\r\n        if (v === undefined || v === null) return '';\r\n        return JSON.stringify( v );\r\n    },\r\n    castStringArray: function(v) {\r\n        if( Array.isArray( v ) ) return v;\r\n        if( v === null || v === undefined ) return [];\r\n        if( typeof v === 'string' ) {\r\n            return v.split( ',' ).map(String.trim);\r\n        }\r\n        return [JSON.stringify( v )];\r\n    },\r\n    castUnit: function(v) {\r\n        if( !v ) return { v: 0, u: 'px' };\r\n        if( typeof v.v !== 'undefined' ) {\r\n            v.v = parseFloat( v.v );\r\n            if( isNaN( v.v ) ) return { v: 0, u: 'px' };\r\n            if( typeof v.u !== 'string' ) v.u = 'px';\r\n            return { v: v.v, u: v.u };\r\n        }\r\n        if( typeof v === 'number' ) return { v: v, u: 'px' };\r\n        if( typeof v !== 'string' ) return { v: 0, u: 'px' };\r\n        return ParseUnit( '' + v );\r\n    },\r\n    castValidator: function(v) {\r\n        if (typeof v === 'function') return v;\r\n        if (typeof v === 'boolean') return function() { return v; };\r\n        if (typeof v === 'string' && v.trim().length != 0 ) {\r\n            try {\r\n                var rx = new RegExp( v );\r\n                return rx.test.bind( rx );\r\n            }\r\n            // Ignore Regular Expression errors.\r\n            catch (ex) {\r\n                console.error(\"[castValidator] /\" + v + \"/ \", ex);\r\n            }\r\n        };\r\n        return function() { return null; };\r\n    }\r\n};\r\n\r\n/**\r\n * @param {any|function} val - Default value, or a specific getter (if `val` is a function).\r\n */\r\nfunction propCast( caster, obj, att, val ) {\r\n    var hasSpecialGetter = typeof val === 'function';\r\n    if( typeof obj[ID] === 'undefined' ) obj[ID] = {};\r\n    obj[ID][att] = {\r\n        value: val,\r\n        event: new Listeners()\r\n    };\r\n    var setter;\r\n    if (typeof caster === 'function') {\r\n        setter = function(v) {\r\n            v = caster( v );\r\n            // If there is a special getter, any set will fire.\r\n            // Otherwise, we fire only if the value has changed.\r\n            if( hasSpecialGetter || obj[ID][att].value !== v) {\r\n                obj[ID][att].value = v;\r\n                obj[ID][att].event.fire( v, obj, att );\r\n            }\r\n        };\r\n    } else {\r\n        setter = function(v) {\r\n            // If there is a special getter, any set will fire.\r\n            // Otherwise, we fire only if the value has changed.\r\n            if( hasSpecialGetter || obj[ID][att].value !== v ) {\r\n                obj[ID][att].value = v;\r\n                obj[ID][att].event.fire( v, obj, att );\r\n            }\r\n        };\r\n    }\r\n    var getter = val;\r\n    if (!hasSpecialGetter) {\r\n        // Default getter.\r\n        getter = function() { return obj[ID][att].value; };\r\n    }\r\n    Object.defineProperty( obj, att, {\r\n        get: getter,\r\n        set: setter,\r\n        configurable: false,\r\n        enumerable: true\r\n    });\r\n    return exports.bind.bind(exports, obj, att);\r\n};\r\n\r\n/**\r\n * @export function fire\r\n *\r\n * Set a new value and fire the event even if the value has not changed.\r\n */\r\nexports.fire = function( obj, att, val ) {\r\n    var currentValue = obj[att];\r\n    if( typeof val === 'undefined' ) val = currentValue;\r\n\r\n    obj[ID][att].value = val;\r\n    obj[ID][att].event.fire( obj[att], obj, att );\r\n};\r\n\r\n/**\r\n * @export function set\r\n *\r\n * Set a new value without firing any event.\r\n */\r\nexports.set = function( obj, att, val ) {\r\n    if( typeof obj[ID] === 'undefined' ) obj[ID] = {};\r\n    if( typeof obj[ID][att] === 'undefined' ) obj[ID][att] = {};\r\n    obj[ID][att].value = val;\r\n};\r\n\r\n/**\r\n * @export function get\r\n *\r\n * Get a value without firing any event.\r\n */\r\nexports.get = function( obj, att ) {\r\n    if( typeof obj[ID] === 'undefined' ) return undefined;\r\n    if( typeof obj[ID][att] === 'undefined' ) return undefined;\r\n    return obj[ID][att].value;\r\n};\r\n\r\n/**\r\n * Create a property on which we can bind another property.\r\n * \r\n * @param {object} obj - Object to which we want to add a property.\r\n * @param {string} att - Name of the attribute of `obj`.\r\n * \r\n */\r\nexports.prop = propCast.bind( null, null );\r\n/**\r\n * @export @function propToggleClass\r\n * Create an enum attribute which toggles a CSS class when assigned.\r\n *\r\n * @param {array|object} values - If this is an array, we will convert\r\n * it  into an  object.  For instance `[\"show\",  \"hide\"]` will  become\r\n * `{show: \"show\", hide: \"hide\"}`.\r\n */\r\nexports.propToggleClass = function( target, attribute, values, prefix ) {\r\n    if( typeof prefix !== 'string' ) prefix = '';\r\n    var convertedValues = {};\r\n    if (typeof values === 'string') {\r\n        convertedValues[values] = values;\r\n    }\r\n    else if (Array.isArray(values)) {\r\n        values.forEach(function (itm) {\r\n            convertedValues[itm] = itm;\r\n        });\r\n    }\r\n    else {\r\n        convertedValues = values;\r\n    }\r\n    propCast( null, target, attribute )(function(v) {\r\n        var key, val;\r\n        for( key in convertedValues ) {\r\n            val = convertedValues[key];\r\n            if (key == v) {\r\n                $.addClass( target.element, prefix + val);\r\n            } else {\r\n                $.removeClass( target.element, prefix + val);\r\n            }\r\n        }\r\n    });\r\n};\r\n/**\r\n * @export @function propAddClass\r\n * Create a boolean attribute that toggle a CSS class on the `element` attribute of `target`.\r\n * If the value id `true`, `className` is added.\r\n * @example\r\n * DB.propAddClass( this, 'wide', 'fullscreen' );\r\n * DB.propAddClass( this, 'wide' );\r\n */\r\nexports.propAddClass = function( target, attribute, className ) {\r\n    if( typeof className === 'undefined' ) className = attribute;\r\n    propCast( converters.castBoolean, target, attribute )(function(v) {\r\n        if (v) $.addClass( target.element, className );\r\n        else $.removeClass( target.element, className );\r\n    });\r\n};\r\n/**\r\n * @export @function propAddClass\r\n * Create a boolean attribute that toggle a CSS class on the `element` attribute of `target`.\r\n * If the value id `true`, `className` is removed.\r\n * @example\r\n * DB.propRemoveClass( this, 'visible', 'hide' );\r\n */\r\nexports.propRemoveClass = function( target, attribute, className ) {\r\n    if( typeof className === 'undefined' ) className = attribute;\r\n    propCast( converters.castBoolean, target, attribute )(function(v) {\r\n        if (v) $.removeClass( target.element, className );\r\n        else $.addClass( target.element, className );\r\n    });\r\n};\r\nexports.propArray = propCast.bind( null, converters.castArray );\r\nexports.propBoolean = propCast.bind( null, converters.castBoolean );\r\nexports.propColor = propCast.bind( null, converters.castColor );\r\nexports.propDate = propCast.bind( null, converters.castDate );\r\nexports.propEnum = function( enumeration ) {\r\n    return propCast.bind( null, converters.castEnum( enumeration ) );\r\n};\r\nexports.propInteger = propCast.bind( null, converters.castInteger );\r\nexports.propRegexp = propCast.bind( null, converters.castRegexp );\r\nexports.propString = propCast.bind( null, converters.castString );\r\nexports.propStringArray = propCast.bind( null, converters.castStringArray );\r\nexports.propUnit = propCast.bind( null, converters.castUnit );\r\nexports.propValidator = propCast.bind( null, converters.castValidator );\r\n\r\nexports.bind = function( srcObj, srcAtt, dstObj, dstAtt, options ) {\r\n    if( typeof srcObj[ID] === 'undefined' || typeof srcObj[ID][srcAtt] === 'undefined' ) {\r\n        console.error( srcAtt + \" is not a bindable property of \", srcObj );\r\n        throw Error( srcAtt + \" is not a bindable property!\" );\r\n    }\r\n\r\n    if( typeof options === 'undefined' ) options = {};\r\n    if (options.value) {\r\n        options.converter = function() {\r\n            return options.value;\r\n        };\r\n    }\r\n    var lambda = typeof dstObj === 'function' ? dstObj : function(v, obj, att) {\r\n        dstObj[dstAtt] = typeof options.converter === 'function' ? options.converter(v) : v;\r\n    };\r\n    srcObj[ID][srcAtt].event.add( lambda );\r\n\r\n    return options;\r\n};\r\n\r\n\r\nexports.extend = function( def, ext, obj ) {\r\n    var out = JSON.parse( JSON.stringify( def ) );\r\n\r\n    var key, val;\r\n    for( key in ext ) {\r\n        if (key.charAt(0) == '$') continue;\r\n        val = ext[key];\r\n        if( typeof out[key] === 'undefined' ) {\r\n            console.error(\"[tfw.data-binding.extend] Undefined argument: `\" + key + \"`!\");\r\n        } else {\r\n            out[key] = val;\r\n        }\r\n    }\r\n\r\n    if (typeof obj !== 'undefined') {\r\n        for( key in ext ) {\r\n            if (key.charAt(0) != '$') continue;\r\n            Object.defineProperty( obj, key, {\r\n                value: ext[key],\r\n                writable: false,\r\n                configurable: false,\r\n                enumerable: false\r\n            });\r\n        }\r\n        // Setting values.\r\n        for( key in out ) {\r\n            if (key.charAt(0) == '$') continue;\r\n            obj[key] = out[key];\r\n        }\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n\r\nexports.converters = converters;\r\n\r\n\r\n  \r\nmodule.exports._ = _;\n/**\n * @module tfw.data-binding\n * @see module:$\n * @see module:polyfill.string\n * @see module:dom\n * @see module:tfw.css\n * @see module:tfw.listeners\n\n */\n});","zip":"require(\"tfw.data-binding\",function(n,e,t){function r(n,e,r,o){var i=\"function\"==typeof o;\"undefined\"==typeof e[f]&&(e[f]={}),e[f][r]={value:o,event:new a};var u;u=\"function\"==typeof n?function(t){t=n(t),(i||e[f][r].value!==t)&&(e[f][r].value=t,e[f][r].event.fire(t,e,r))}:function(n){(i||e[f][r].value!==n)&&(e[f][r].value=n,e[f][r].event.fire(n,e,r))};var l=o;return i||(l=function(){return e[f][r].value}),Object.defineProperty(e,r,{get:l,set:u,configurable:!1,enumerable:!0}),t.bind.bind(t,e,r)}var o=function(){function e(){return r(t,arguments)}var t={en:{}},r=n(\"$\").intl;return e.all=t,e}();n(\"polyfill.string\");var i=n(\"dom\"),u=n(\"tfw.css\").parseUnit,a=n(\"tfw.listeners\"),f=\"_tfw.data-binding_\",l={castArray:function(n){return Array.isArray(n)?n:null===n||void 0===n?[]:[n]},castBoolean:function(n){if(\"boolean\"==typeof n)return n;if(\"string\"==typeof n){if(n=n.trim().toLowerCase(),\"1\"==n||\"true\"==n||\"yes\"==n)return!0;if(\"0\"==n||\"false\"==n||\"no\"==n)return!1}return\"number\"==typeof n?!!n:null},castColor:function(n){return\"\"+n},castDate:function(n){return\"number\"==typeof n||\"string\"==typeof n?new Date(n):n instanceof Date?n:new Date},castEnum:function(n){var e=n.map(String.toLowerCase);return function(t){if(\"number\"==typeof t)return n[Math.floor(t)%n.length];if(\"string\"!=typeof t)return n[0];var r=e.indexOf(t.trim().toLowerCase());return r<0&&(r=0),n[r]}},castInteger:function(n){return\"number\"==typeof n?Math.floor(n):\"boolean\"==typeof n?n?1:0:\"string\"==typeof n?parseInt(n):Number.NaN},castRegexp:function(n){if(n instanceof RegExp)return n;if(\"string\"==typeof n&&0!=n.trim().length)try{return new RegExp(n)}catch(e){console.error(\"[castRegexp] /\"+n+\"/ \",e)}return null},castString:function(n){return\"string\"==typeof n?n:void 0===n||null===n?\"\":JSON.stringify(n)},castStringArray:function(n){return Array.isArray(n)?n:null===n||void 0===n?[]:\"string\"==typeof n?n.split(\",\").map(String.trim):[JSON.stringify(n)]},castUnit:function(n){return n?\"undefined\"!=typeof n.v?(n.v=parseFloat(n.v),isNaN(n.v)?{v:0,u:\"px\"}:(\"string\"!=typeof n.u&&(n.u=\"px\"),{v:n.v,u:n.u})):\"number\"==typeof n?{v:n,u:\"px\"}:\"string\"!=typeof n?{v:0,u:\"px\"}:u(\"\"+n):{v:0,u:\"px\"}},castValidator:function(n){if(\"function\"==typeof n)return n;if(\"boolean\"==typeof n)return function(){return n};if(\"string\"==typeof n&&0!=n.trim().length)try{var e=new RegExp(n);return e.test.bind(e)}catch(e){console.error(\"[castValidator] /\"+n+\"/ \",e)}return function(){return null}}};t.fire=function(n,e,t){var r=n[e];\"undefined\"==typeof t&&(t=r),n[f][e].value=t,n[f][e].event.fire(n[e],n,e)},t.set=function(n,e,t){\"undefined\"==typeof n[f]&&(n[f]={}),\"undefined\"==typeof n[f][e]&&(n[f][e]={}),n[f][e].value=t},t.get=function(n,e){if(\"undefined\"!=typeof n[f]&&\"undefined\"!=typeof n[f][e])return n[f][e].value},t.prop=r.bind(null,null),t.propToggleClass=function(n,e,t,o){\"string\"!=typeof o&&(o=\"\");var u={};\"string\"==typeof t?u[t]=t:Array.isArray(t)?t.forEach(function(n){u[n]=n}):u=t,r(null,n,e)(function(e){var t,r;for(t in u)r=u[t],t==e?i.addClass(n.element,o+r):i.removeClass(n.element,o+r)})},t.propAddClass=function(n,e,t){\"undefined\"==typeof t&&(t=e),r(l.castBoolean,n,e)(function(e){e?i.addClass(n.element,t):i.removeClass(n.element,t)})},t.propRemoveClass=function(n,e,t){\"undefined\"==typeof t&&(t=e),r(l.castBoolean,n,e)(function(e){e?i.removeClass(n.element,t):i.addClass(n.element,t)})},t.propArray=r.bind(null,l.castArray),t.propBoolean=r.bind(null,l.castBoolean),t.propColor=r.bind(null,l.castColor),t.propDate=r.bind(null,l.castDate),t.propEnum=function(n){return r.bind(null,l.castEnum(n))},t.propInteger=r.bind(null,l.castInteger),t.propRegexp=r.bind(null,l.castRegexp),t.propString=r.bind(null,l.castString),t.propStringArray=r.bind(null,l.castStringArray),t.propUnit=r.bind(null,l.castUnit),t.propValidator=r.bind(null,l.castValidator),t.bind=function(n,e,t,r,o){if(\"undefined\"==typeof n[f]||\"undefined\"==typeof n[f][e])throw console.error(e+\" is not a bindable property of \",n),Error(e+\" is not a bindable property!\");\"undefined\"==typeof o&&(o={}),o.value&&(o.converter=function(){return o.value});var i=\"function\"==typeof t?t:function(n,e,i){t[r]=\"function\"==typeof o.converter?o.converter(n):n};return n[f][e].event.add(i),o},t.extend=function(n,e,t){var r,o,i=JSON.parse(JSON.stringify(n));for(r in e)\"$\"!=r.charAt(0)&&(o=e[r],\"undefined\"==typeof i[r]?console.error(\"[tfw.data-binding.extend] Undefined argument: `\"+r+\"`!\"):i[r]=o);if(\"undefined\"!=typeof t){for(r in e)\"$\"==r.charAt(0)&&Object.defineProperty(t,r,{value:e[r],writable:!1,configurable:!1,enumerable:!1});for(r in i)\"$\"!=r.charAt(0)&&(t[r]=i[r])}return i},t.converters=l,e.exports._=o});\n//# sourceMappingURL=tfw.data-binding.js.map","map":{"version":3,"file":"tfw.data-binding.js","sources":["tfw.data-binding.js"],"sourcesContent":["/** @module tfw.data-binding */require( 'tfw.data-binding', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n    /**\r\n * @module\r\n *\r\n * Provide all the functions needed for data-binding.\r\n *\r\n * @example\r\n * var DB = require('tfw.data-binding');\r\n * DB.propAddClass( widget, 'visible', 'show' );\r\n */\r\nrequire(\"polyfill.string\");\r\nvar $ = require(\"dom\");\r\nvar ParseUnit = require(\"tfw.css\").parseUnit;\r\nvar Listeners = require(\"tfw.listeners\");\r\n\r\n\r\nvar ID = '_tfw.data-binding_';\r\n\r\nvar converters = {\r\n    castArray: function(v) {\r\n        if (Array.isArray( v )) return v;\r\n        if( v === null || v === undefined ) return [];\r\n        return [v];\r\n    },\r\n    castBoolean: function(v) {\r\n        if (typeof v === 'boolean') return v;\r\n        if (typeof v === 'string') {\r\n            v = v.trim().toLowerCase();\r\n            if (v == '1' || v == 'true' || v == 'yes') {\r\n                return true;\r\n            } else if (v == '0' || v == 'false' || v == 'no') {\r\n                return false;\r\n            }\r\n        }\r\n        if (typeof v === 'number') {\r\n            return v ? true : false;\r\n        }\r\n        return null;\r\n    },\r\n    castColor: function(v) {\r\n        return \"\" + v;\r\n    },\r\n    castDate: function(v) {\r\n        if( typeof v === 'number' || typeof v === 'string' )\r\n            return new Date(v);\r\n        if( v instanceof Date ) return v;\r\n        return new Date();\r\n    },\r\n    castEnum: function( enumeration ) {\r\n        var lowerCaseEnum = enumeration.map(String.toLowerCase);\r\n        return function(v) {\r\n            if (typeof v === 'number') {\r\n                return enumeration[Math.floor( v ) % enumeration.length];\r\n            }\r\n            if (typeof v !== 'string') return enumeration[0];\r\n            var idx = lowerCaseEnum.indexOf( v.trim().toLowerCase() );\r\n            if (idx < 0) idx = 0;\r\n            return enumeration[idx];\r\n        };\r\n    },\r\n    castInteger: function(v) {\r\n        if (typeof v === 'number') {\r\n            return Math.floor( v );\r\n        }\r\n        if (typeof v === 'boolean') return v ? 1 : 0;\r\n        if (typeof v === 'string') {\r\n            return parseInt( v );\r\n        }\r\n        return Number.NaN;\r\n    },\r\n    castRegexp: function(v) {\r\n        if (v instanceof RegExp) return v;\r\n        if (typeof v === 'string' && v.trim().length != 0 ) {\r\n            try {\r\n                return new RegExp( v );\r\n            }\r\n            // Ignore Regular Expression errors.\r\n            catch (ex) {\r\n                console.error(\"[castRegexp] /\" + v + \"/ \", ex);\r\n            }\r\n        };\r\n        return null;\r\n    },\r\n    castString: function(v) {\r\n        if (typeof v === 'string') return v;\r\n        if (v === undefined || v === null) return '';\r\n        return JSON.stringify( v );\r\n    },\r\n    castStringArray: function(v) {\r\n        if( Array.isArray( v ) ) return v;\r\n        if( v === null || v === undefined ) return [];\r\n        if( typeof v === 'string' ) {\r\n            return v.split( ',' ).map(String.trim);\r\n        }\r\n        return [JSON.stringify( v )];\r\n    },\r\n    castUnit: function(v) {\r\n        if( !v ) return { v: 0, u: 'px' };\r\n        if( typeof v.v !== 'undefined' ) {\r\n            v.v = parseFloat( v.v );\r\n            if( isNaN( v.v ) ) return { v: 0, u: 'px' };\r\n            if( typeof v.u !== 'string' ) v.u = 'px';\r\n            return { v: v.v, u: v.u };\r\n        }\r\n        if( typeof v === 'number' ) return { v: v, u: 'px' };\r\n        if( typeof v !== 'string' ) return { v: 0, u: 'px' };\r\n        return ParseUnit( '' + v );\r\n    },\r\n    castValidator: function(v) {\r\n        if (typeof v === 'function') return v;\r\n        if (typeof v === 'boolean') return function() { return v; };\r\n        if (typeof v === 'string' && v.trim().length != 0 ) {\r\n            try {\r\n                var rx = new RegExp( v );\r\n                return rx.test.bind( rx );\r\n            }\r\n            // Ignore Regular Expression errors.\r\n            catch (ex) {\r\n                console.error(\"[castValidator] /\" + v + \"/ \", ex);\r\n            }\r\n        };\r\n        return function() { return null; };\r\n    }\r\n};\r\n\r\n/**\r\n * @param {any|function} val - Default value, or a specific getter (if `val` is a function).\r\n */\r\nfunction propCast( caster, obj, att, val ) {\r\n    var hasSpecialGetter = typeof val === 'function';\r\n    if( typeof obj[ID] === 'undefined' ) obj[ID] = {};\r\n    obj[ID][att] = {\r\n        value: val,\r\n        event: new Listeners()\r\n    };\r\n    var setter;\r\n    if (typeof caster === 'function') {\r\n        setter = function(v) {\r\n            v = caster( v );\r\n            // If there is a special getter, any set will fire.\r\n            // Otherwise, we fire only if the value has changed.\r\n            if( hasSpecialGetter || obj[ID][att].value !== v) {\r\n                obj[ID][att].value = v;\r\n                obj[ID][att].event.fire( v, obj, att );\r\n            }\r\n        };\r\n    } else {\r\n        setter = function(v) {\r\n            // If there is a special getter, any set will fire.\r\n            // Otherwise, we fire only if the value has changed.\r\n            if( hasSpecialGetter || obj[ID][att].value !== v ) {\r\n                obj[ID][att].value = v;\r\n                obj[ID][att].event.fire( v, obj, att );\r\n            }\r\n        };\r\n    }\r\n    var getter = val;\r\n    if (!hasSpecialGetter) {\r\n        // Default getter.\r\n        getter = function() { return obj[ID][att].value; };\r\n    }\r\n    Object.defineProperty( obj, att, {\r\n        get: getter,\r\n        set: setter,\r\n        configurable: false,\r\n        enumerable: true\r\n    });\r\n    return exports.bind.bind(exports, obj, att);\r\n};\r\n\r\n/**\r\n * @export function fire\r\n *\r\n * Set a new value and fire the event even if the value has not changed.\r\n */\r\nexports.fire = function( obj, att, val ) {\r\n    var currentValue = obj[att];\r\n    if( typeof val === 'undefined' ) val = currentValue;\r\n\r\n    obj[ID][att].value = val;\r\n    obj[ID][att].event.fire( obj[att], obj, att );\r\n};\r\n\r\n/**\r\n * @export function set\r\n *\r\n * Set a new value without firing any event.\r\n */\r\nexports.set = function( obj, att, val ) {\r\n    if( typeof obj[ID] === 'undefined' ) obj[ID] = {};\r\n    if( typeof obj[ID][att] === 'undefined' ) obj[ID][att] = {};\r\n    obj[ID][att].value = val;\r\n};\r\n\r\n/**\r\n * @export function get\r\n *\r\n * Get a value without firing any event.\r\n */\r\nexports.get = function( obj, att ) {\r\n    if( typeof obj[ID] === 'undefined' ) return undefined;\r\n    if( typeof obj[ID][att] === 'undefined' ) return undefined;\r\n    return obj[ID][att].value;\r\n};\r\n\r\n/**\r\n * Create a property on which we can bind another property.\r\n * \r\n * @param {object} obj - Object to which we want to add a property.\r\n * @param {string} att - Name of the attribute of `obj`.\r\n * \r\n */\r\nexports.prop = propCast.bind( null, null );\r\n/**\r\n * @export @function propToggleClass\r\n * Create an enum attribute which toggles a CSS class when assigned.\r\n *\r\n * @param {array|object} values - If this is an array, we will convert\r\n * it  into an  object.  For instance `[\"show\",  \"hide\"]` will  become\r\n * `{show: \"show\", hide: \"hide\"}`.\r\n */\r\nexports.propToggleClass = function( target, attribute, values, prefix ) {\r\n    if( typeof prefix !== 'string' ) prefix = '';\r\n    var convertedValues = {};\r\n    if (typeof values === 'string') {\r\n        convertedValues[values] = values;\r\n    }\r\n    else if (Array.isArray(values)) {\r\n        values.forEach(function (itm) {\r\n            convertedValues[itm] = itm;\r\n        });\r\n    }\r\n    else {\r\n        convertedValues = values;\r\n    }\r\n    propCast( null, target, attribute )(function(v) {\r\n        var key, val;\r\n        for( key in convertedValues ) {\r\n            val = convertedValues[key];\r\n            if (key == v) {\r\n                $.addClass( target.element, prefix + val);\r\n            } else {\r\n                $.removeClass( target.element, prefix + val);\r\n            }\r\n        }\r\n    });\r\n};\r\n/**\r\n * @export @function propAddClass\r\n * Create a boolean attribute that toggle a CSS class on the `element` attribute of `target`.\r\n * If the value id `true`, `className` is added.\r\n * @example\r\n * DB.propAddClass( this, 'wide', 'fullscreen' );\r\n * DB.propAddClass( this, 'wide' );\r\n */\r\nexports.propAddClass = function( target, attribute, className ) {\r\n    if( typeof className === 'undefined' ) className = attribute;\r\n    propCast( converters.castBoolean, target, attribute )(function(v) {\r\n        if (v) $.addClass( target.element, className );\r\n        else $.removeClass( target.element, className );\r\n    });\r\n};\r\n/**\r\n * @export @function propAddClass\r\n * Create a boolean attribute that toggle a CSS class on the `element` attribute of `target`.\r\n * If the value id `true`, `className` is removed.\r\n * @example\r\n * DB.propRemoveClass( this, 'visible', 'hide' );\r\n */\r\nexports.propRemoveClass = function( target, attribute, className ) {\r\n    if( typeof className === 'undefined' ) className = attribute;\r\n    propCast( converters.castBoolean, target, attribute )(function(v) {\r\n        if (v) $.removeClass( target.element, className );\r\n        else $.addClass( target.element, className );\r\n    });\r\n};\r\nexports.propArray = propCast.bind( null, converters.castArray );\r\nexports.propBoolean = propCast.bind( null, converters.castBoolean );\r\nexports.propColor = propCast.bind( null, converters.castColor );\r\nexports.propDate = propCast.bind( null, converters.castDate );\r\nexports.propEnum = function( enumeration ) {\r\n    return propCast.bind( null, converters.castEnum( enumeration ) );\r\n};\r\nexports.propInteger = propCast.bind( null, converters.castInteger );\r\nexports.propRegexp = propCast.bind( null, converters.castRegexp );\r\nexports.propString = propCast.bind( null, converters.castString );\r\nexports.propStringArray = propCast.bind( null, converters.castStringArray );\r\nexports.propUnit = propCast.bind( null, converters.castUnit );\r\nexports.propValidator = propCast.bind( null, converters.castValidator );\r\n\r\nexports.bind = function( srcObj, srcAtt, dstObj, dstAtt, options ) {\r\n    if( typeof srcObj[ID] === 'undefined' || typeof srcObj[ID][srcAtt] === 'undefined' ) {\r\n        console.error( srcAtt + \" is not a bindable property of \", srcObj );\r\n        throw Error( srcAtt + \" is not a bindable property!\" );\r\n    }\r\n\r\n    if( typeof options === 'undefined' ) options = {};\r\n    if (options.value) {\r\n        options.converter = function() {\r\n            return options.value;\r\n        };\r\n    }\r\n    var lambda = typeof dstObj === 'function' ? dstObj : function(v, obj, att) {\r\n        dstObj[dstAtt] = typeof options.converter === 'function' ? options.converter(v) : v;\r\n    };\r\n    srcObj[ID][srcAtt].event.add( lambda );\r\n\r\n    return options;\r\n};\r\n\r\n\r\nexports.extend = function( def, ext, obj ) {\r\n    var out = JSON.parse( JSON.stringify( def ) );\r\n\r\n    var key, val;\r\n    for( key in ext ) {\r\n        if (key.charAt(0) == '$') continue;\r\n        val = ext[key];\r\n        if( typeof out[key] === 'undefined' ) {\r\n            console.error(\"[tfw.data-binding.extend] Undefined argument: `\" + key + \"`!\");\r\n        } else {\r\n            out[key] = val;\r\n        }\r\n    }\r\n\r\n    if (typeof obj !== 'undefined') {\r\n        for( key in ext ) {\r\n            if (key.charAt(0) != '$') continue;\r\n            Object.defineProperty( obj, key, {\r\n                value: ext[key],\r\n                writable: false,\r\n                configurable: false,\r\n                enumerable: false\r\n            });\r\n        }\r\n        // Setting values.\r\n        for( key in out ) {\r\n            if (key.charAt(0) == '$') continue;\r\n            obj[key] = out[key];\r\n        }\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n\r\nexports.converters = converters;\r\n\r\n\r\n  \r\nmodule.exports._ = _;\n});"],"names":["require","module","exports","propCast","caster","obj","att","val","hasSpecialGetter","ID","value","event","Listeners","setter","v","fire","getter","Object","defineProperty","get","set","configurable","enumerable","bind","_","X","D","arguments","en","intl","all","$","ParseUnit","parseUnit","converters","castArray","Array","isArray","undefined","castBoolean","trim","toLowerCase","castColor","castDate","Date","castEnum","enumeration","lowerCaseEnum","map","String","Math","floor","length","idx","indexOf","castInteger","parseInt","Number","NaN","castRegexp","RegExp","ex","console","error","castString","JSON","stringify","castStringArray","split","castUnit","parseFloat","isNaN","u","castValidator","rx","test","currentValue","prop","propToggleClass","target","attribute","values","prefix","convertedValues","forEach","itm","key","addClass","element","removeClass","propAddClass","className","propRemoveClass","propArray","propBoolean","propColor","propDate","propEnum","propInteger","propRegexp","propString","propStringArray","propUnit","propValidator","srcObj","srcAtt","dstObj","dstAtt","options","Error","converter","lambda","add","extend","def","ext","out","parse","charAt","writable"],"mappings":"AAA+BA,QAAS,mBAAoB,SAASA,EAASC,EAAQC,GAgItF,QAASC,GAAUC,EAAQC,EAAKC,EAAKC,GACjC,GAAIC,GAAkC,kBAARD,EACP,oBAAZF,GAAII,KAAsBJ,EAAII,OACzCJ,EAAII,GAAIH,IACJI,MAAOH,EACPI,MAAO,GAAIC,GAEf,IAAIC,EAEAA,GADkB,kBAAXT,GACE,SAASU,GACdA,EAAIV,EAAQU,IAGRN,GAAoBH,EAAII,GAAIH,GAAKI,QAAUI,KAC3CT,EAAII,GAAIH,GAAKI,MAAQI,EACrBT,EAAII,GAAIH,GAAKK,MAAMI,KAAMD,EAAGT,EAAKC,KAIhC,SAASQ,IAGVN,GAAoBH,EAAII,GAAIH,GAAKI,QAAUI,KAC3CT,EAAII,GAAIH,GAAKI,MAAQI,EACrBT,EAAII,GAAIH,GAAKK,MAAMI,KAAMD,EAAGT,EAAKC,IAI7C,IAAIU,GAAST,CAWb,OAVKC,KAEDQ,EAAS,WAAa,MAAOX,GAAII,GAAIH,GAAKI,QAE9CO,OAAOC,eAAgBb,EAAKC,GACxBa,IAAKH,EACLI,IAAKP,EACLQ,cAAc,EACdC,YAAY,IAETpB,EAAQqB,KAAKA,KAAKrB,EAASG,EAAKC,GAvKsD,GAAIkB,GAAE,WAA+C,QAASA,KAAI,MAAOC,GAAEC,EAAEC,WAA5D,GAAID,IAAGE,OAASH,EAAEzB,EAAQ,KAAK6B,IAAiD,OAARL,GAAEM,IAAIJ,EAASF,IAUzMxB,GAAQ,kBACR,IAAI+B,GAAI/B,EAAQ,OACZgC,EAAYhC,EAAQ,WAAWiC,UAC/BrB,EAAYZ,EAAQ,iBAGpBS,EAAK,qBAELyB,GACAC,UAAW,SAASrB,GAChB,MAAIsB,OAAMC,QAASvB,GAAYA,EACrB,OAANA,GAAoBwB,SAANxB,MACVA,IAEZyB,YAAa,SAASzB,GAClB,GAAiB,iBAANA,GAAiB,MAAOA,EACnC,IAAiB,gBAANA,GAAgB,CAEvB,GADAA,EAAIA,EAAE0B,OAAOC,cACJ,KAAL3B,GAAiB,QAALA,GAAoB,OAALA,EAC3B,OAAO,CACJ,IAAS,KAALA,GAAiB,SAALA,GAAqB,MAALA,EACnC,OAAO,EAGf,MAAiB,gBAANA,KACAA,EAEJ,MAEX4B,UAAW,SAAS5B,GAChB,MAAO,GAAKA,GAEhB6B,SAAU,SAAS7B,GACf,MAAiB,gBAANA,IAA+B,gBAANA,GACzB,GAAI8B,MAAK9B,GAChBA,YAAa8B,MAAc9B,EACxB,GAAI8B,OAEfC,SAAU,SAAUC,GAChB,GAAIC,GAAgBD,EAAYE,IAAIC,OAAOR,YAC3C,OAAO,UAAS3B,GACZ,GAAiB,gBAANA,GACP,MAAOgC,GAAYI,KAAKC,MAAOrC,GAAMgC,EAAYM,OAErD,IAAiB,gBAANtC,GAAgB,MAAOgC,GAAY,EAC9C,IAAIO,GAAMN,EAAcO,QAASxC,EAAE0B,OAAOC,cAE1C,OADIY,GAAM,IAAGA,EAAM,GACZP,EAAYO,KAG3BE,YAAa,SAASzC,GAClB,MAAiB,gBAANA,GACAoC,KAAKC,MAAOrC,GAEN,iBAANA,GAAwBA,EAAI,EAAI,EAC1B,gBAANA,GACA0C,SAAU1C,GAEd2C,OAAOC,KAElBC,WAAY,SAAS7C,GACjB,GAAIA,YAAa8C,QAAQ,MAAO9C,EAChC,IAAiB,gBAANA,IAAqC,GAAnBA,EAAE0B,OAAOY,OAClC,IACI,MAAO,IAAIQ,QAAQ9C,GAGvB,MAAO+C,GACHC,QAAQC,MAAM,iBAAmBjD,EAAI,KAAM+C,GAGnD,MAAO,OAEXG,WAAY,SAASlD,GACjB,MAAiB,gBAANA,GAAuBA,EACxBwB,SAANxB,GAAyB,OAANA,EAAmB,GACnCmD,KAAKC,UAAWpD,IAE3BqD,gBAAiB,SAASrD,GACtB,MAAIsB,OAAMC,QAASvB,GAAaA,EACtB,OAANA,GAAoBwB,SAANxB,KACD,gBAANA,GACAA,EAAEsD,MAAO,KAAMpB,IAAIC,OAAOT,OAE7ByB,KAAKC,UAAWpD,KAE5BuD,SAAU,SAASvD,GACf,MAAKA,GACc,mBAARA,GAAEA,GACTA,EAAEA,EAAIwD,WAAYxD,EAAEA,GAChByD,MAAOzD,EAAEA,IAAeA,EAAG,EAAG0D,EAAG,OAClB,gBAAR1D,GAAE0D,IAAiB1D,EAAE0D,EAAI,OAC3B1D,EAAGA,EAAEA,EAAG0D,EAAG1D,EAAE0D,KAET,gBAAN1D,IAA0BA,EAAGA,EAAG0D,EAAG,MAC7B,gBAAN1D,IAA0BA,EAAG,EAAG0D,EAAG,MACvCxC,EAAW,GAAKlB,IATLA,EAAG,EAAG0D,EAAG,OAW/BC,cAAe,SAAS3D,GACpB,GAAiB,kBAANA,GAAkB,MAAOA,EACpC,IAAiB,iBAANA,GAAiB,MAAO,YAAa,MAAOA,GACvD,IAAiB,gBAANA,IAAqC,GAAnBA,EAAE0B,OAAOY,OAClC,IACI,GAAIsB,GAAK,GAAId,QAAQ9C,EACrB,OAAO4D,GAAGC,KAAKpD,KAAMmD,GAGzB,MAAOb,GACHC,QAAQC,MAAM,oBAAsBjD,EAAI,KAAM+C,GAGtD,MAAO,YAAa,MAAO,QAsDnC3D,GAAQa,KAAO,SAAUV,EAAKC,EAAKC,GAC/B,GAAIqE,GAAevE,EAAIC,EACJ,oBAARC,KAAsBA,EAAMqE,GAEvCvE,EAAII,GAAIH,GAAKI,MAAQH,EACrBF,EAAII,GAAIH,GAAKK,MAAMI,KAAMV,EAAIC,GAAMD,EAAKC,IAQ5CJ,EAAQkB,IAAM,SAAUf,EAAKC,EAAKC,GACP,mBAAZF,GAAII,KAAsBJ,EAAII,OACb,mBAAjBJ,GAAII,GAAIH,KAAuBD,EAAII,GAAIH,OAClDD,EAAII,GAAIH,GAAKI,MAAQH,GAQzBL,EAAQiB,IAAM,SAAUd,EAAKC,GACzB,GAAuB,mBAAZD,GAAII,IACa,mBAAjBJ,GAAII,GAAIH,GACnB,MAAOD,GAAII,GAAIH,GAAKI,OAUxBR,EAAQ2E,KAAO1E,EAASoB,KAAM,KAAM,MASpCrB,EAAQ4E,gBAAkB,SAAUC,EAAQC,EAAWC,EAAQC,GACrC,gBAAXA,KAAsBA,EAAS,GAC1C,IAAIC,KACkB,iBAAXF,GACPE,EAAgBF,GAAUA,EAErB7C,MAAMC,QAAQ4C,GACnBA,EAAOG,QAAQ,SAAUC,GACrBF,EAAgBE,GAAOA,IAI3BF,EAAkBF,EAEtB9E,EAAU,KAAM4E,EAAQC,GAAY,SAASlE,GACzC,GAAIwE,GAAK/E,CACT,KAAK+E,IAAOH,GACR5E,EAAM4E,EAAgBG,GAClBA,GAAOxE,EACPiB,EAAEwD,SAAUR,EAAOS,QAASN,EAAS3E,GAErCwB,EAAE0D,YAAaV,EAAOS,QAASN,EAAS3E,MAaxDL,EAAQwF,aAAe,SAAUX,EAAQC,EAAWW,GACvB,mBAAdA,KAA4BA,EAAYX,GACnD7E,EAAU+B,EAAWK,YAAawC,EAAQC,GAAY,SAASlE,GACvDA,EAAGiB,EAAEwD,SAAUR,EAAOS,QAASG,GAC9B5D,EAAE0D,YAAaV,EAAOS,QAASG,MAU5CzF,EAAQ0F,gBAAkB,SAAUb,EAAQC,EAAWW,GAC1B,mBAAdA,KAA4BA,EAAYX,GACnD7E,EAAU+B,EAAWK,YAAawC,EAAQC,GAAY,SAASlE,GACvDA,EAAGiB,EAAE0D,YAAaV,EAAOS,QAASG,GACjC5D,EAAEwD,SAAUR,EAAOS,QAASG,MAGzCzF,EAAQ2F,UAAY1F,EAASoB,KAAM,KAAMW,EAAWC,WACpDjC,EAAQ4F,YAAc3F,EAASoB,KAAM,KAAMW,EAAWK,aACtDrC,EAAQ6F,UAAY5F,EAASoB,KAAM,KAAMW,EAAWQ,WACpDxC,EAAQ8F,SAAW7F,EAASoB,KAAM,KAAMW,EAAWS,UACnDzC,EAAQ+F,SAAW,SAAUnD,GACzB,MAAO3C,GAASoB,KAAM,KAAMW,EAAWW,SAAUC,KAErD5C,EAAQgG,YAAc/F,EAASoB,KAAM,KAAMW,EAAWqB,aACtDrD,EAAQiG,WAAahG,EAASoB,KAAM,KAAMW,EAAWyB,YACrDzD,EAAQkG,WAAajG,EAASoB,KAAM,KAAMW,EAAW8B,YACrD9D,EAAQmG,gBAAkBlG,EAASoB,KAAM,KAAMW,EAAWiC,iBAC1DjE,EAAQoG,SAAWnG,EAASoB,KAAM,KAAMW,EAAWmC,UACnDnE,EAAQqG,cAAgBpG,EAASoB,KAAM,KAAMW,EAAWuC,eAExDvE,EAAQqB,KAAO,SAAUiF,EAAQC,EAAQC,EAAQC,EAAQC,GACrD,GAA0B,mBAAfJ,GAAO/F,IAAqD,mBAAvB+F,GAAO/F,GAAIgG,GAEvD,KADA3C,SAAQC,MAAO0C,EAAS,kCAAmCD,GACrDK,MAAOJ,EAAS,+BAGH,oBAAZG,KAA0BA,MACjCA,EAAQlG,QACRkG,EAAQE,UAAY,WAChB,MAAOF,GAAQlG,OAGvB,IAAIqG,GAA2B,kBAAXL,GAAwBA,EAAS,SAAS5F,EAAGT,EAAKC,GAClEoG,EAAOC,GAAuC,kBAAtBC,GAAQE,UAA2BF,EAAQE,UAAUhG,GAAKA,EAItF,OAFA0F,GAAO/F,GAAIgG,GAAQ9F,MAAMqG,IAAKD,GAEvBH,GAIX1G,EAAQ+G,OAAS,SAAUC,EAAKC,EAAK9G,GACjC,GAEIiF,GAAK/E,EAFL6G,EAAMnD,KAAKoD,MAAOpD,KAAKC,UAAWgD,GAGtC,KAAK5B,IAAO6B,GACa,KAAjB7B,EAAIgC,OAAO,KACf/G,EAAM4G,EAAI7B,GACc,mBAAb8B,GAAI9B,GACXxB,QAAQC,MAAM,kDAAoDuB,EAAM,MAExE8B,EAAI9B,GAAO/E,EAInB,IAAmB,mBAARF,GAAqB,CAC5B,IAAKiF,IAAO6B,GACa,KAAjB7B,EAAIgC,OAAO,IACfrG,OAAOC,eAAgBb,EAAKiF,GACxB5E,MAAOyG,EAAI7B,GACXiC,UAAU,EACVlG,cAAc,EACdC,YAAY,GAIpB,KAAKgE,IAAO8B,GACa,KAAjB9B,EAAIgC,OAAO,KACfjH,EAAIiF,GAAO8B,EAAI9B,IAIvB,MAAO8B,IAIXlH,EAAQgC,WAAaA,EAIrBjC,EAAOC,QAAQsB,EAAIA"},"dependencies":["mod/$","mod/polyfill.string","mod/dom","mod/tfw.css","mod/tfw.listeners"]}