{"intl":"var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n","src":"/** @module dom.fx */require( 'dom.fx', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n    \"use strict\";\r\n\r\nrequire(\"polyfill.promise\");\r\nvar $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\n\r\nvar delay = window.setTimeout;\r\n\r\nvar EMPTY_FUNC = function() {};\r\nvar ID = 1;\r\n\r\nvar Fx = function( name ) {\r\n    // Because it is  possible to call `end()` before  the sequence is\r\n    // over, we need  to know in what  session we are. This  way, if a\r\n    // callback is called after the end,  it can know that it must not\r\n    // be execute the next task.\r\n    this._session = {};\r\n    // A name can be defined for debug purpose, but it is not used right now.\r\n    Object.defineProperty( Fx.prototype, 'name', {\r\n        value: name,\r\n        writable: false,\r\n        configurable: true,\r\n        enumerable: true\r\n    });\r\n    this._name = name;\r\n    // Sequence of  tasks. A task  is a function with  two parameters:\r\n    // the `next()` function and a  boolean `async` which tells you if\r\n    // your are allowed to call async functions.\r\n    // When  a task  is  called in  the `end()`  function,  it is  not\r\n    // allowed to call async functions.\r\n    this._tasks = [];\r\n    // Index of the current task.\r\n    this._index = 0;\r\n    this._started = false;\r\n    this._startTime = 0;\r\n    this._onEnd = EMPTY_FUNC;\r\n};\r\n\r\n/**\r\n * @member Fx.go\r\n * @param\r\n */\r\nFx.prototype.start = function(onEnd) {\r\n    if( this._started ) this.end();\r\n    if (typeof onEnd !== 'function' ) onEnd = EMPTY_FUNC;\r\n    this._onEnd = onEnd;\r\n    this._started = true;\r\n    this._index = 0;\r\n    this._session = { $id: ID++ };\r\n    this._startTime = Date.now();\r\n    next.call( this, this._session );\r\n};\r\n\r\nfunction next( session ) {\r\n    if( session != this._session ) return;\r\n    if( this._index >= this._tasks.length ) {\r\n        this._index = 0;\r\n        this._started = false;\r\n        delete this._session;\r\n        this._onEnd( this );\r\n        return;\r\n    }\r\n\r\n    var that = this;\r\n    var tsk = this._tasks[this._index++];\r\n    if( this._debug ) {\r\n        console.info( \"[dom.fx] tsk[\" + (this._index - 1) + \"]: \", tsk.label,\r\n                      \"(\" + (Date.now() - this._startTime) + \" ms)\", tsk.args, session );\r\n    }\r\n    tsk(function(){\r\n        delay( next.bind( that, session ) );\r\n    }, true);\r\n};\r\n\r\nFx.prototype.end = function() {\r\n    if( !this._started ) return this;\r\n    var that = this;\r\n    this._started = false;\r\n    delete this._session;\r\n    while( this._index < this._tasks.length ) {\r\n        var tsk = this._tasks[this._index++];\r\n        if( that._debug ) {\r\n            console.info( \"[dom.fx.end] tsk[\" + (this._index - 1) + \"]: \", tsk.label, tsk.args );\r\n        }\r\n        tsk( EMPTY_FUNC, false );\r\n    }\r\n    this._onEnd( this );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @member Fx.debug\r\n * @param value\r\n */\r\nFx.prototype.debug = function(value) {\r\n    this.addTask( function( next ) {\r\n        this._debug = value ? true : false;\r\n        next();\r\n    });\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nFx.prototype.addTask = function( task, label, args ) {\r\n    task.label = label;\r\n    task.args = args;\r\n    this._tasks.push( task );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nFx.prototype.log = function(msg) {\r\n    this.addTask(function(next) {\r\n        console.log( \"[dom.fx]\", msg );\r\n        next();\r\n    }, 'log');\r\n    return this;\r\n};\r\n\r\n/**\r\n * Stop execution of the animation until end() has been called.\r\n */\r\nFx.prototype.pause = function() {\r\n    this.addTask( EMPTY_FUNC, 'pause' );\r\n    return this;\r\n};\r\n\r\nFx.prototype.exec = function(msg) {\r\n    var args = Array.prototype.slice.call( arguments );\r\n    this.addTask(function(next, session) {\r\n        args.forEach(function (arg) {\r\n            try {\r\n                if( typeof arg === 'function' ) arg( session );\r\n                else console.log( '[dom.fx]', arg );\r\n            }\r\n            catch( ex ) {\r\n                console.error( ex );\r\n            }\r\n        });\r\n        next();\r\n    }, 'exec', args );\r\n    return this;\r\n};\r\n\r\n[\r\n    'css', 'addClass', 'removeClass', 'toggleClass', 'detach',\r\n    'saveStyle', 'restoreStyle', 'add', 'removeAtt', 'replace'\r\n].forEach(function (methodname) {\r\n    var slot = $[methodname];\r\n    Fx.prototype[methodname] = function() {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        this.addTask(function(next) {\r\n            slot.apply( $, args );\r\n            next();\r\n        }, methodname, args );\r\n        return this;\r\n    };\r\n});\r\n\r\n\r\n/**\r\n * @member Fx.vanish\r\n * @param elem, ms\r\n */\r\nFx.prototype.vanish = function(elem, ms) {\r\n    ms = parseInt( ms );\r\n    if( isNaN( ms ) ) ms = 300;\r\n    return this.css( elem, { transition: \"none\" } )\r\n        .css(elem, { transition: \"opacity \" + ms + \"ms\", opacity: 0 } )\r\n        .wait( ms );\r\n};\r\n\r\n\r\n/**\r\n * @member Fx.wait\r\n * @param ms\r\n */\r\nFx.prototype.wait = function(msOrElem) {\r\n    var that = this;\r\n    var args = Array.prototype.slice.call( arguments );\r\n\r\n    if( typeof msOrElem === 'undefined' ) msOrElem = 0;\r\n    if( typeof msOrElem === 'number' ) {\r\n        this.addTask(function(next, async) {\r\n            if( async ) {\r\n                delay(next, msOrElem);\r\n            }\r\n        }, 'wait', args );\r\n    } else {\r\n        this.addTask(function(next, async) {\r\n            if( async ) {\r\n                var e = $(msOrElem);\r\n                var slot = function(evt) {\r\n                    ['transitionend', 'oTransitionEnd', 'webkitTransitionEnd'].forEach(function (itm) {\r\n                        e.removeEventListener( itm, slot );\r\n                    });\r\n                    next();\r\n                };\r\n                ['transitionend', 'oTransitionEnd', 'webkitTransitionEnd'].forEach(function (itm) {\r\n                    e.addEventListener( itm, slot );\r\n                });\r\n            }\r\n        }, 'wait', args );\r\n    }\r\n    return this;\r\n};\r\n\r\n\r\nmodule.exports = function( name ) {\r\n    return new Fx( name );\r\n};\r\n\r\n\r\n/**\r\n * @module dom.fx\r\n *\r\n * @description\r\n * All the animation effects you can do on DOM elements.\r\n *\r\n * @example\r\n * var mod = require('dom.fx');\r\n */\r\n\r\n\r\n/**\r\n * @export {function} fullscreen\r\n * @param opts\r\n * * __target__: target DOM element.\r\n *\r\n * @return {object}\r\n * * __value__    {boolean}:    If    `true`    the    element    goes\r\n fullscreen. Otherwise, it returns to its initial position.\r\n */\r\nmodule.exports.Fullscreen = function( opts ) {\r\n    if( typeof opts === 'undefined' ) {\r\n        throw Error(\"[dom.fx:fullscreen] Missing argument!\");\r\n    }\r\n    if( typeof opts.target === 'undefined' ) {\r\n        throw Error(\"[dom.fx:fullscreen] Missing `opts.target`!\");\r\n    }\r\n    if (typeof opts.target.element === 'function') opts.target = opts.target.element();\r\n    if( typeof opts.target.element !== 'undefined' ) opts.target = opts.target.element;\r\n\r\n    var voidFunc = function() {};\r\n    var tools = {\r\n        onBeforeReplace: typeof opts.onBeforeReplace === 'function' ? opts.onBeforeReplace : voidFunc,\r\n        onAfterReplace: typeof opts.onAfterReplace === 'function' ? opts.onAfterReplace : voidFunc\r\n    };\r\n    DB.propBoolean(this, 'value')(function(isFullScreen) {\r\n        if (isFullScreen) {\r\n            fullscreenOn( opts.target, tools );\r\n        } else {\r\n            fullscreenOff( opts.target, tools );\r\n        }\r\n    });\r\n};\r\n\r\nfunction fullscreenOn( target, tools ) {\r\n    if (tools.terminate) tools.terminate();\r\n\r\n    var rect = target.getBoundingClientRect();\r\n    console.info(\"[dom.fx] rect=...\", rect);\r\n    var substitute = $.div();\r\n    $.css(substitute, {\r\n        display: 'inline-block',\r\n        width: rect.width + \"px\",\r\n        height: rect.height + \"px\"\r\n    });\r\n\r\n    tools.onBeforeReplace( target );\r\n    $.replace( substitute, target );\r\n    tools.onAfterReplace( target );\r\n\r\n    tools.substitute = substitute;\r\n    tools.styles = saveStyles( target );\r\n    tools.overlay = $.div('dom-fx-fullscreen');\r\n    document.body.appendChild( tools.overlay );\r\n    tools.overlay.appendChild( target );\r\n    $.css(target, {\r\n        left: rect.left + 'px',\r\n        top: rect.top + 'px',\r\n        width: rect.width + 'px',\r\n        height: rect.height + 'px'\r\n    });\r\n    $.addClass(target, 'dom-fx-fullscreen-target');\r\n\r\n    delay(function() {\r\n        var r2 = tools.overlay.getBoundingClientRect();\r\n        $.css(target, {\r\n            left: '20px',\r\n            top: '20px',\r\n            width: (r2.width - 40) + 'px',\r\n            height: (r2.height - 40) + 'px'\r\n        });\r\n    });\r\n}\r\n\r\nfunction fullscreenOff( target, tools ) {\r\n    var rect = tools.substitute.getBoundingClientRect();\r\n    $.css(target, {\r\n        left: rect.left + 'px',\r\n        top: rect.top + 'px',\r\n        width: rect.width + 'px',\r\n        height: rect.height + 'px'\r\n    });\r\n    tools.terminate = function() {\r\n        $.detach( tools.overlay );\r\n\r\n        tools.onBeforeReplace( target );\r\n        $.replace( target, tools.substitute );\r\n        tools.onAfterReplace( target );\r\n\r\n        loadStyles( target, tools.styles );\r\n        delete tools.terminate;\r\n    };\r\n\r\n    delay(tools.terminate, 200);\r\n}\r\n\r\nfunction saveStyles( element ) {\r\n    var styles = {};\r\n    var key, val;\r\n    for( key in element.style ) {\r\n        val = element.style[key];\r\n        styles[key] = val;\r\n    }\r\n    console.info(\"[dom.fx] styles=...\", styles);\r\n    return styles;\r\n}\r\n\r\nfunction loadStyles( element, styles ) {\r\n    for( var key in styles ) {\r\n        element.style[key] = styles[key];\r\n    }\r\n}\r\n\r\n\r\n  \r\nmodule.exports._ = _;\n/**\n * @module dom.fx\n * @see module:$\n * @see module:polyfill.promise\n * @see module:dom\n * @see module:tfw.data-binding\n\n */\n});","zip":"require(\"dom.fx\",function(t,e,n){function i(t){if(t==this._session){if(this._index>=this._tasks.length)return this._index=0,this._started=!1,delete this._session,void this._onEnd(this);var e=this,n=this._tasks[this._index++];this._debug&&console.info(\"[dom.fx] tsk[\"+(this._index-1)+\"]: \",n.label,\"(\"+(Date.now()-this._startTime)+\" ms)\",n.args,t),n(function(){c(i.bind(e,t))},!0)}}function o(t,e){e.terminate&&e.terminate();var n=t.getBoundingClientRect();console.info(\"[dom.fx] rect=...\",n);var i=f.div();f.css(i,{display:\"inline-block\",width:n.width+\"px\",height:n.height+\"px\"}),e.onBeforeReplace(t),f.replace(i,t),e.onAfterReplace(t),e.substitute=i,e.styles=r(t),e.overlay=f.div(\"dom-fx-fullscreen\"),document.body.appendChild(e.overlay),e.overlay.appendChild(t),f.css(t,{left:n.left+\"px\",top:n.top+\"px\",width:n.width+\"px\",height:n.height+\"px\"}),f.addClass(t,\"dom-fx-fullscreen-target\"),c(function(){var n=e.overlay.getBoundingClientRect();f.css(t,{left:\"20px\",top:\"20px\",width:n.width-40+\"px\",height:n.height-40+\"px\"})})}function s(t,e){var n=e.substitute.getBoundingClientRect();f.css(t,{left:n.left+\"px\",top:n.top+\"px\",width:n.width+\"px\",height:n.height+\"px\"}),e.terminate=function(){f.detach(e.overlay),e.onBeforeReplace(t),f.replace(t,e.substitute),e.onAfterReplace(t),a(t,e.styles),delete e.terminate},c(e.terminate,200)}function r(t){var e,n,i={};for(e in t.style)n=t.style[e],i[e]=n;return console.info(\"[dom.fx] styles=...\",i),i}function a(t,e){for(var n in e)t.style[n]=e[n]}var d=function(){function e(){return i(n,arguments)}var n={en:{}},i=t(\"$\").intl;return e.all=n,e}();t(\"polyfill.promise\");var f=t(\"dom\"),l=t(\"tfw.data-binding\"),c=window.setTimeout,h=function(){},p=1,u=function(t){this._session={},Object.defineProperty(u.prototype,\"name\",{value:t,writable:!1,configurable:!0,enumerable:!0}),this._name=t,this._tasks=[],this._index=0,this._started=!1,this._startTime=0,this._onEnd=h};u.prototype.start=function(t){this._started&&this.end(),\"function\"!=typeof t&&(t=h),this._onEnd=t,this._started=!0,this._index=0,this._session={$id:p++},this._startTime=Date.now(),i.call(this,this._session)},u.prototype.end=function(){if(!this._started)return this;var t=this;for(this._started=!1,delete this._session;this._index<this._tasks.length;){var e=this._tasks[this._index++];t._debug&&console.info(\"[dom.fx.end] tsk[\"+(this._index-1)+\"]: \",e.label,e.args),e(h,!1)}return this._onEnd(this),this},u.prototype.debug=function(t){return this.addTask(function(e){this._debug=!!t,e()}),this},u.prototype.addTask=function(t,e,n){return t.label=e,t.args=n,this._tasks.push(t),this},u.prototype.log=function(t){return this.addTask(function(e){console.log(\"[dom.fx]\",t),e()},\"log\"),this},u.prototype.pause=function(){return this.addTask(h,\"pause\"),this},u.prototype.exec=function(t){var e=Array.prototype.slice.call(arguments);return this.addTask(function(t,n){e.forEach(function(t){try{\"function\"==typeof t?t(n):console.log(\"[dom.fx]\",t)}catch(t){console.error(t)}}),t()},\"exec\",e),this},[\"css\",\"addClass\",\"removeClass\",\"toggleClass\",\"detach\",\"saveStyle\",\"restoreStyle\",\"add\",\"removeAtt\",\"replace\"].forEach(function(t){var e=f[t];u.prototype[t]=function(){var n=Array.prototype.slice.call(arguments);return this.addTask(function(t){e.apply(f,n),t()},t,n),this}}),u.prototype.vanish=function(t,e){return e=parseInt(e),isNaN(e)&&(e=300),this.css(t,{transition:\"none\"}).css(t,{transition:\"opacity \"+e+\"ms\",opacity:0}).wait(e)},u.prototype.wait=function(t){var e=Array.prototype.slice.call(arguments);return\"undefined\"==typeof t&&(t=0),\"number\"==typeof t?this.addTask(function(e,n){n&&c(e,t)},\"wait\",e):this.addTask(function(e,n){if(n){var i=f(t),o=function(t){[\"transitionend\",\"oTransitionEnd\",\"webkitTransitionEnd\"].forEach(function(t){i.removeEventListener(t,o)}),e()};[\"transitionend\",\"oTransitionEnd\",\"webkitTransitionEnd\"].forEach(function(t){i.addEventListener(t,o)})}},\"wait\",e),this},e.exports=function(t){return new u(t)},e.exports.Fullscreen=function(t){if(\"undefined\"==typeof t)throw Error(\"[dom.fx:fullscreen] Missing argument!\");if(\"undefined\"==typeof t.target)throw Error(\"[dom.fx:fullscreen] Missing `opts.target`!\");\"function\"==typeof t.target.element&&(t.target=t.target.element()),\"undefined\"!=typeof t.target.element&&(t.target=t.target.element);var e=function(){},n={onBeforeReplace:\"function\"==typeof t.onBeforeReplace?t.onBeforeReplace:e,onAfterReplace:\"function\"==typeof t.onAfterReplace?t.onAfterReplace:e};l.propBoolean(this,\"value\")(function(e){e?o(t.target,n):s(t.target,n)})},e.exports._=d});\n//# sourceMappingURL=dom.fx.js.map","map":{"version":3,"file":"dom.fx.js","sources":["dom.fx.js"],"sourcesContent":["/** @module dom.fx */require( 'dom.fx', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n    \"use strict\";\r\n\r\nrequire(\"polyfill.promise\");\r\nvar $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\n\r\nvar delay = window.setTimeout;\r\n\r\nvar EMPTY_FUNC = function() {};\r\nvar ID = 1;\r\n\r\nvar Fx = function( name ) {\r\n    // Because it is  possible to call `end()` before  the sequence is\r\n    // over, we need  to know in what  session we are. This  way, if a\r\n    // callback is called after the end,  it can know that it must not\r\n    // be execute the next task.\r\n    this._session = {};\r\n    // A name can be defined for debug purpose, but it is not used right now.\r\n    Object.defineProperty( Fx.prototype, 'name', {\r\n        value: name,\r\n        writable: false,\r\n        configurable: true,\r\n        enumerable: true\r\n    });\r\n    this._name = name;\r\n    // Sequence of  tasks. A task  is a function with  two parameters:\r\n    // the `next()` function and a  boolean `async` which tells you if\r\n    // your are allowed to call async functions.\r\n    // When  a task  is  called in  the `end()`  function,  it is  not\r\n    // allowed to call async functions.\r\n    this._tasks = [];\r\n    // Index of the current task.\r\n    this._index = 0;\r\n    this._started = false;\r\n    this._startTime = 0;\r\n    this._onEnd = EMPTY_FUNC;\r\n};\r\n\r\n/**\r\n * @member Fx.go\r\n * @param\r\n */\r\nFx.prototype.start = function(onEnd) {\r\n    if( this._started ) this.end();\r\n    if (typeof onEnd !== 'function' ) onEnd = EMPTY_FUNC;\r\n    this._onEnd = onEnd;\r\n    this._started = true;\r\n    this._index = 0;\r\n    this._session = { $id: ID++ };\r\n    this._startTime = Date.now();\r\n    next.call( this, this._session );\r\n};\r\n\r\nfunction next( session ) {\r\n    if( session != this._session ) return;\r\n    if( this._index >= this._tasks.length ) {\r\n        this._index = 0;\r\n        this._started = false;\r\n        delete this._session;\r\n        this._onEnd( this );\r\n        return;\r\n    }\r\n\r\n    var that = this;\r\n    var tsk = this._tasks[this._index++];\r\n    if( this._debug ) {\r\n        console.info( \"[dom.fx] tsk[\" + (this._index - 1) + \"]: \", tsk.label,\r\n                      \"(\" + (Date.now() - this._startTime) + \" ms)\", tsk.args, session );\r\n    }\r\n    tsk(function(){\r\n        delay( next.bind( that, session ) );\r\n    }, true);\r\n};\r\n\r\nFx.prototype.end = function() {\r\n    if( !this._started ) return this;\r\n    var that = this;\r\n    this._started = false;\r\n    delete this._session;\r\n    while( this._index < this._tasks.length ) {\r\n        var tsk = this._tasks[this._index++];\r\n        if( that._debug ) {\r\n            console.info( \"[dom.fx.end] tsk[\" + (this._index - 1) + \"]: \", tsk.label, tsk.args );\r\n        }\r\n        tsk( EMPTY_FUNC, false );\r\n    }\r\n    this._onEnd( this );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @member Fx.debug\r\n * @param value\r\n */\r\nFx.prototype.debug = function(value) {\r\n    this.addTask( function( next ) {\r\n        this._debug = value ? true : false;\r\n        next();\r\n    });\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nFx.prototype.addTask = function( task, label, args ) {\r\n    task.label = label;\r\n    task.args = args;\r\n    this._tasks.push( task );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nFx.prototype.log = function(msg) {\r\n    this.addTask(function(next) {\r\n        console.log( \"[dom.fx]\", msg );\r\n        next();\r\n    }, 'log');\r\n    return this;\r\n};\r\n\r\n/**\r\n * Stop execution of the animation until end() has been called.\r\n */\r\nFx.prototype.pause = function() {\r\n    this.addTask( EMPTY_FUNC, 'pause' );\r\n    return this;\r\n};\r\n\r\nFx.prototype.exec = function(msg) {\r\n    var args = Array.prototype.slice.call( arguments );\r\n    this.addTask(function(next, session) {\r\n        args.forEach(function (arg) {\r\n            try {\r\n                if( typeof arg === 'function' ) arg( session );\r\n                else console.log( '[dom.fx]', arg );\r\n            }\r\n            catch( ex ) {\r\n                console.error( ex );\r\n            }\r\n        });\r\n        next();\r\n    }, 'exec', args );\r\n    return this;\r\n};\r\n\r\n[\r\n    'css', 'addClass', 'removeClass', 'toggleClass', 'detach',\r\n    'saveStyle', 'restoreStyle', 'add', 'removeAtt', 'replace'\r\n].forEach(function (methodname) {\r\n    var slot = $[methodname];\r\n    Fx.prototype[methodname] = function() {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        this.addTask(function(next) {\r\n            slot.apply( $, args );\r\n            next();\r\n        }, methodname, args );\r\n        return this;\r\n    };\r\n});\r\n\r\n\r\n/**\r\n * @member Fx.vanish\r\n * @param elem, ms\r\n */\r\nFx.prototype.vanish = function(elem, ms) {\r\n    ms = parseInt( ms );\r\n    if( isNaN( ms ) ) ms = 300;\r\n    return this.css( elem, { transition: \"none\" } )\r\n        .css(elem, { transition: \"opacity \" + ms + \"ms\", opacity: 0 } )\r\n        .wait( ms );\r\n};\r\n\r\n\r\n/**\r\n * @member Fx.wait\r\n * @param ms\r\n */\r\nFx.prototype.wait = function(msOrElem) {\r\n    var that = this;\r\n    var args = Array.prototype.slice.call( arguments );\r\n\r\n    if( typeof msOrElem === 'undefined' ) msOrElem = 0;\r\n    if( typeof msOrElem === 'number' ) {\r\n        this.addTask(function(next, async) {\r\n            if( async ) {\r\n                delay(next, msOrElem);\r\n            }\r\n        }, 'wait', args );\r\n    } else {\r\n        this.addTask(function(next, async) {\r\n            if( async ) {\r\n                var e = $(msOrElem);\r\n                var slot = function(evt) {\r\n                    ['transitionend', 'oTransitionEnd', 'webkitTransitionEnd'].forEach(function (itm) {\r\n                        e.removeEventListener( itm, slot );\r\n                    });\r\n                    next();\r\n                };\r\n                ['transitionend', 'oTransitionEnd', 'webkitTransitionEnd'].forEach(function (itm) {\r\n                    e.addEventListener( itm, slot );\r\n                });\r\n            }\r\n        }, 'wait', args );\r\n    }\r\n    return this;\r\n};\r\n\r\n\r\nmodule.exports = function( name ) {\r\n    return new Fx( name );\r\n};\r\n\r\n\r\n/**\r\n * @module dom.fx\r\n *\r\n * @description\r\n * All the animation effects you can do on DOM elements.\r\n *\r\n * @example\r\n * var mod = require('dom.fx');\r\n */\r\n\r\n\r\n/**\r\n * @export {function} fullscreen\r\n * @param opts\r\n * * __target__: target DOM element.\r\n *\r\n * @return {object}\r\n * * __value__    {boolean}:    If    `true`    the    element    goes\r\n fullscreen. Otherwise, it returns to its initial position.\r\n */\r\nmodule.exports.Fullscreen = function( opts ) {\r\n    if( typeof opts === 'undefined' ) {\r\n        throw Error(\"[dom.fx:fullscreen] Missing argument!\");\r\n    }\r\n    if( typeof opts.target === 'undefined' ) {\r\n        throw Error(\"[dom.fx:fullscreen] Missing `opts.target`!\");\r\n    }\r\n    if (typeof opts.target.element === 'function') opts.target = opts.target.element();\r\n    if( typeof opts.target.element !== 'undefined' ) opts.target = opts.target.element;\r\n\r\n    var voidFunc = function() {};\r\n    var tools = {\r\n        onBeforeReplace: typeof opts.onBeforeReplace === 'function' ? opts.onBeforeReplace : voidFunc,\r\n        onAfterReplace: typeof opts.onAfterReplace === 'function' ? opts.onAfterReplace : voidFunc\r\n    };\r\n    DB.propBoolean(this, 'value')(function(isFullScreen) {\r\n        if (isFullScreen) {\r\n            fullscreenOn( opts.target, tools );\r\n        } else {\r\n            fullscreenOff( opts.target, tools );\r\n        }\r\n    });\r\n};\r\n\r\nfunction fullscreenOn( target, tools ) {\r\n    if (tools.terminate) tools.terminate();\r\n\r\n    var rect = target.getBoundingClientRect();\r\n    console.info(\"[dom.fx] rect=...\", rect);\r\n    var substitute = $.div();\r\n    $.css(substitute, {\r\n        display: 'inline-block',\r\n        width: rect.width + \"px\",\r\n        height: rect.height + \"px\"\r\n    });\r\n\r\n    tools.onBeforeReplace( target );\r\n    $.replace( substitute, target );\r\n    tools.onAfterReplace( target );\r\n\r\n    tools.substitute = substitute;\r\n    tools.styles = saveStyles( target );\r\n    tools.overlay = $.div('dom-fx-fullscreen');\r\n    document.body.appendChild( tools.overlay );\r\n    tools.overlay.appendChild( target );\r\n    $.css(target, {\r\n        left: rect.left + 'px',\r\n        top: rect.top + 'px',\r\n        width: rect.width + 'px',\r\n        height: rect.height + 'px'\r\n    });\r\n    $.addClass(target, 'dom-fx-fullscreen-target');\r\n\r\n    delay(function() {\r\n        var r2 = tools.overlay.getBoundingClientRect();\r\n        $.css(target, {\r\n            left: '20px',\r\n            top: '20px',\r\n            width: (r2.width - 40) + 'px',\r\n            height: (r2.height - 40) + 'px'\r\n        });\r\n    });\r\n}\r\n\r\nfunction fullscreenOff( target, tools ) {\r\n    var rect = tools.substitute.getBoundingClientRect();\r\n    $.css(target, {\r\n        left: rect.left + 'px',\r\n        top: rect.top + 'px',\r\n        width: rect.width + 'px',\r\n        height: rect.height + 'px'\r\n    });\r\n    tools.terminate = function() {\r\n        $.detach( tools.overlay );\r\n\r\n        tools.onBeforeReplace( target );\r\n        $.replace( target, tools.substitute );\r\n        tools.onAfterReplace( target );\r\n\r\n        loadStyles( target, tools.styles );\r\n        delete tools.terminate;\r\n    };\r\n\r\n    delay(tools.terminate, 200);\r\n}\r\n\r\nfunction saveStyles( element ) {\r\n    var styles = {};\r\n    var key, val;\r\n    for( key in element.style ) {\r\n        val = element.style[key];\r\n        styles[key] = val;\r\n    }\r\n    console.info(\"[dom.fx] styles=...\", styles);\r\n    return styles;\r\n}\r\n\r\nfunction loadStyles( element, styles ) {\r\n    for( var key in styles ) {\r\n        element.style[key] = styles[key];\r\n    }\r\n}\r\n\r\n\r\n  \r\nmodule.exports._ = _;\n});"],"names":["require","module","exports","next","session","this","_session","_index","_tasks","length","_started","_onEnd","that","tsk","_debug","console","info","label","Date","now","_startTime","args","delay","bind","fullscreenOn","target","tools","terminate","rect","getBoundingClientRect","substitute","$","div","css","display","width","height","onBeforeReplace","replace","onAfterReplace","styles","saveStyles","overlay","document","body","appendChild","left","top","addClass","r2","fullscreenOff","detach","loadStyles","element","key","val","style","_","X","D","arguments","en","intl","all","DB","window","setTimeout","EMPTY_FUNC","ID","Fx","name","Object","defineProperty","prototype","value","writable","configurable","enumerable","_name","start","onEnd","end","$id","call","debug","addTask","task","push","log","msg","pause","exec","Array","slice","forEach","arg","ex","error","methodname","slot","apply","vanish","elem","ms","parseInt","isNaN","transition","opacity","wait","msOrElem","async","e","evt","itm","removeEventListener","addEventListener","Fullscreen","opts","Error","voidFunc","propBoolean","isFullScreen"],"mappings":"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"},"dependencies":["mod/$","mod/polyfill.promise","mod/dom","mod/tfw.data-binding"]}