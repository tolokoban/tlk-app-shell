/**
 * This is an application container.
 * It manages updates in background.
 */

"use strict";

var $ = require("dom");
var Err = require("tfw.message").error;
var Modal = require("wdg.modal");

var FS = require("node://fs");


exports.start = function() {
    FS.readFile("package.json", function(err, out) {
        if( err ) {
            Err( err );
            return;
        }
        try {
            var jsn = out.toString();
            var pkg = JSON.parse( out.toString() );
            $('title').textContent = pkg.name + " " + pkg.version;
        } catch( ex ) {
            Err("Bad JSON syntax in `package.json`!");
            return;
        }
        $('iframe').setAttribute( 'src', 'index.html' );
    });
};


exports.onExit = function() {
    Modal.confirm(_('confirm-exit'), function() {
        nw.Window.get().close();
    });
};
